<!DOCTYPE html>
<html>
	<head>
		<title>Test Admin Settings</title>
		<style>
			body {
				font-family: Arial, sans-serif;
				max-width: 800px;
				margin: 50px auto;
				padding: 20px;
			}
			.settings-group {
				background: #f8f9fa;
				padding: 20px;
				margin: 20px 0;
				border-radius: 5px;
			}
			.form-group {
				margin: 15px 0;
			}
			label {
				display: block;
				font-weight: bold;
				margin-bottom: 5px;
			}
			input,
			textarea {
				width: 100%;
				padding: 8px;
				margin-bottom: 10px;
				border: 1px solid #ddd;
				border-radius: 4px;
			}
			button {
				background: #007bff;
				color: white;
				padding: 10px 20px;
				border: none;
				border-radius: 4px;
				cursor: pointer;
			}
			button:hover {
				background: #0056b3;
			}
			.success {
				color: green;
				font-weight: bold;
			}
			.error {
				color: red;
				font-weight: bold;
			}
		</style>
	</head>
	<body>
		<h1>üîß Test Trang Admin Settings</h1>

		<div class="settings-group">
			<h2>üìä Current Settings from API</h2>
			<div id="current-settings">Loading...</div>
		</div>

		<div class="settings-group">
			<h2>‚úèÔ∏è Update Settings</h2>
			<form id="settings-form">
				<div class="form-group">
					<label>Site Name:</label>
					<input type="text" name="site_name" id="site_name" />
				</div>

				<div class="form-group">
					<label>Site Logo:</label>
					<input type="text" name="site_logo" id="site_logo" />
				</div>

				<div class="form-group">
					<label>Site Slogan:</label>
					<input type="text" name="site_slogan" id="site_slogan" />
				</div>

				<div class="form-group">
					<label>Phone Number:</label>
					<input type="text" name="phone_number" id="phone_number" />
				</div>

				<div class="form-group">
					<label>Email:</label>
					<input type="email" name="email" id="email" />
				</div>

				<button type="submit">üíæ Update Settings</button>
			</form>

			<div id="update-result"></div>
		</div>

		<script>
			// Load current settings
			fetch('/healthy/api/get_settings.php')
				.then((response) => response.json())
				.then((data) => {
					if (data.success) {
						const settings = data.settings;

						// Display current settings
						document.getElementById('current-settings').innerHTML =
							'<pre>' +
							JSON.stringify(settings, null, 2) +
							'</pre>';

						// Fill form with current values
						Object.keys(settings).forEach((key) => {
							const input = document.getElementById(key);
							if (input) {
								input.value = settings[key];
							}
						});
					} else {
						document.getElementById('current-settings').innerHTML =
							'<span class="error">Error loading settings</span>';
					}
				})
				.catch((error) => {
					document.getElementById('current-settings').innerHTML =
						'<span class="error">Network error: ' +
						error.message +
						'</span>';
				});

			// Handle form submission
			document
				.getElementById('settings-form')
				.addEventListener('submit', function (e) {
					e.preventDefault();

					const formData = new FormData(this);
					const settings = {};

					for (let [key, value] of formData.entries()) {
						settings[key] = value;
					}

					// Simulate admin session and update
					fetch('/healthy/api/update_settings.php', {
						method: 'POST',
						headers: {
							'Content-Type': 'application/json',
						},
						body: JSON.stringify({
							settings: settings,
						}),
					})
						.then((response) => response.json())
						.then((data) => {
							if (data.success) {
								document.getElementById(
									'update-result'
								).innerHTML =
									'<p class="success">‚úÖ Settings updated successfully!</p>';

								// Reload current settings
								location.reload();
							} else {
								document.getElementById(
									'update-result'
								).innerHTML =
									'<p class="error">‚ùå Error: ' +
									(data.message || 'Unknown error') +
									'</p>';
							}
						})
						.catch((error) => {
							document.getElementById('update-result').innerHTML =
								'<p class="error">‚ùå Network error: ' +
								error.message +
								'</p>';
						});
				});
		</script>
	</body>
</html>
